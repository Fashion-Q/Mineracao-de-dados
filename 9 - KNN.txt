import pandas as pd
import plotly.graph_objects as go
from sklearn import datasets
from sklearn import metrics
from sklearn.model_selection import train_test_split
from sklearn.neighbors import KNeighborsClassifier

vinhos = datasets.load_wine()
df_vinhos = pd.DataFrame(data=vinhos.data,columns=vinhos.feature_names)

df_vinhos

df_vinhos['alvo'] = vinhos.target
df_vinhos['alvo'].unique()

df_vinhos.info()

df_vinhos.describe()

df_vinhos.T

df_vinhos['alvo'].value_counts()

x_train, x_test, y_train, y_test = train_test_split(df_vinhos.iloc[1:].drop('alvo',axis=1),df_vinhos.iloc[1:]['alvo'], test_size=0.1)

knn = KNeighborsClassifier(n_neighbors=3)

knn.fit(x_train, y_train)

resultado = knn.predict(x_test)

print(metrics.classification_report(y_test,resultado,target_names=vinhos.target_names))







